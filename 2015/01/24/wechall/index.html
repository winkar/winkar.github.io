<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="期待已久的寒假，总算可以（比较）自由自在地做自己想做的事情了。    PrimeFactory这道题，寻找一百万以上的素数（并且要求其各数字和也是素数）。乍看之下我以为需要很大的计算量，甚至犹豫了一下要不要用C写。不过还是先决定用python尝试一下。 判断素数的方法我使用的是linux提供的factor，当只能分解出一个数字时便是素数。事实上这个位置的素数还是相当密集的，仅仅在一百万出头一点点就">
<meta property="og:type" content="article">
<meta property="og:title" content="WeChall Journal">
<meta property="og:url" content="http://winkar.github.io/2015/01/24/wechall/index.html">
<meta property="og:site_name" content="陈文青">
<meta property="og:description" content="期待已久的寒假，总算可以（比较）自由自在地做自己想做的事情了。    PrimeFactory这道题，寻找一百万以上的素数（并且要求其各数字和也是素数）。乍看之下我以为需要很大的计算量，甚至犹豫了一下要不要用C写。不过还是先决定用python尝试一下。 判断素数的方法我使用的是linux提供的factor，当只能分解出一个数字时便是素数。事实上这个位置的素数还是相当密集的，仅仅在一百万出头一点点就">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-10-09T12:48:57.350Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="WeChall Journal">
<meta name="twitter:description" content="期待已久的寒假，总算可以（比较）自由自在地做自己想做的事情了。    PrimeFactory这道题，寻找一百万以上的素数（并且要求其各数字和也是素数）。乍看之下我以为需要很大的计算量，甚至犹豫了一下要不要用C写。不过还是先决定用python尝试一下。 判断素数的方法我使用的是linux提供的factor，当只能分解出一个数字时便是素数。事实上这个位置的素数还是相当密集的，仅仅在一百万出头一点点就">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://winkar.github.io/2015/01/24/wechall/">





  <title>WeChall Journal | 陈文青</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">陈文青</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://winkar.github.io/2015/01/24/wechall/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WinKaR">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈文青">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">WeChall Journal</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-01-24T00:00:00+08:00">
                2015-01-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>期待已久的寒假，总算可以（比较）自由自在地做自己想做的事情了。</p>
<!--break-->


<h1 id="PrimeFactory"><a href="#PrimeFactory" class="headerlink" title="PrimeFactory"></a>PrimeFactory</h1><p>这道题，寻找一百万以上的素数（并且要求其各数字和也是素数）。乍看之下我以为需要很大的计算量，甚至犹豫了一下要不要用C写。不过还是先决定用python尝试一下。</p>
<p>判断素数的方法我使用的是linux提供的factor，当只能分解出一个数字时便是素数。<br>事实上这个位置的素数还是相当密集的，仅仅在一百万出头一点点就找到了所需的答案。</p>
<pre><code>import subprocess as sp

t = 1000000
def isPrime(x):
    t = sp.check_output((&quot;factor %d&quot; % x).split())
    if t.split()[1] == str(x):
        return True
    return False

while True:
    t += 1
    if isPrime(t) and isPrime(sum([int(x) for x in str(t)])):
        print t</code></pre><h1 id="Get-Sourced"><a href="#Get-Sourced" class="headerlink" title="Get Sourced"></a>Get Sourced</h1><p>简单查看html源码就能解决问题。不过答案并不在我一开始想象的地方。</p>
<h1 id="Stegano-I"><a href="#Stegano-I" class="headerlink" title="Stegano I"></a>Stegano I</h1><p>在bmp的最后嵌入了密码。xxd,strings,或者随便什么命令。</p>
<h1 id="Crypto-Caesar-I"><a href="#Crypto-Caesar-I" class="headerlink" title="Crypto-Caesar I"></a>Crypto-Caesar I</h1><p>都告诉我是凯撒密码了……用tr命令解决</p>
<pre><code>echo &quot;VJG SWKEM DTQYP HQZ LWORU QXGT VJG NCBA FQI QH ECGUCT CPF AQWT WPKSWG UQNWVKQP KU UDCJRKRJUROQ&quot; | tr [A-Z] [Y-ZA-X]</code></pre><h1 id="WWW-Robots"><a href="#WWW-Robots" class="headerlink" title="WWW-Robots"></a>WWW-Robots</h1><p>流浪人，如果你看到robots.txt……</p>
<h1 id="Ascii"><a href="#Ascii" class="headerlink" title="Ascii:"></a>Ascii:</h1><p>与其说考验知识水平，不如说考验对于这些简单编码的处理速度吧。</p>
<pre><code>a = [84, 104, 101, 32, 115, 111, 108, 117, 116, 105, 111, 110, 32, 105, 115, 58, 32, 99, 98, 104, 108, 100, 105, 110, 110, 111, 110, 109, 111]
s=&quot;&quot;
for t in a:
    s+= chr(t)
print s</code></pre><h1 id="Encoding-URL"><a href="#Encoding-URL" class="headerlink" title="Encoding: URL"></a>Encoding: URL</h1><pre><code>urllib.unquote(&quot;%59%69%70%70%65%68%21%20%59%6F%75%72%20%55%52%4C%20%69%73%20%63%68%61%6C%6C%65%6E%67%65%2F%74%72%61%69%6E%69%6E%67%2F%65%6E%63%6F%64%69%6E%67%73%2F%75%72%6C%2F%73%61%77%5F%6C%6F%74%69%6F%6E%2E%70%68%70%3F%70%3D%64%65%64%67%61%72%73%69%70%70%64%62%26%63%69%64%3D%35%32%23%70%61%73%73%77%6F%72%64%3D%66%69%62%72%65%5F%6F%70%74%69%63%73%20%56%65%72%79%20%77%65%6C%6C%20%64%6F%6E%65%21&quot;)</code></pre><p>说得太直白……</p>
<h1 id="Training-Encodings-I"><a href="#Training-Encodings-I" class="headerlink" title="Training:Encodings I"></a>Training:Encodings I</h1><p>比起上面这道，这道就隐晦多了。<br>对一大串二进制代码的直接反应，是每八个一组形成翻译成字符。然而照做之后解码失败。<br>题目中的提示在于“English”，英文字母所用的ascii字符只占用七个bit。而计算总长度发现不为8的倍数而为7的倍数。</p>
<pre><code>t=&quot;101010011010001101001111001101000001110100110010111110001110100010000011010011110011010000001101110101101110001011010011110100010000011001011101110110001111011111100100110010111001000100000110000111100111100011110100111010010101110010000010110011101111111010111100100100000111000011000011110011111001111101111101111111001011001000100000110100111100110100000110010111000011110011111100111100111110100110000111100101110100110010111100100101110&quot;
print len(t)

def ec(t):
    l = len(t)
    for i in range(l/7):
        yield t[i*7:i*7+7]
s=&quot;&quot;
for c in ec(t):
    s+= chr(int(c,2))
print s</code></pre><h1 id="Training-Programming-1"><a href="#Training-Programming-1" class="headerlink" title="Training: Programming 1"></a>Training: Programming 1</h1><p>这道题无疑是不难的，简单的编程序收发就好了，然而……<br>用python requests跑，不停看到“please use cookie in headers”。<br>于是乎我把header当中能加的东西都加了一遍……直到跟浏览器的请求完全相同，却仍旧不能看到正确的结果</p>
<p>后来我尝试了网上的方案，用ajax。不得不说虽然我不太会js和jquery，但是这个方案的确比我的要方便得多。直接在chrome的控制台输入即可。</p>
<pre><code>$.ajax({
url: &apos;http://www.wechall.net/challenge/training/programming1/index.php?action=request&apos;,
type: &apos;get&apos;,
dataType: &apos;text&apos;,
success:function(data){
var newUrl=&quot;index.php?answer=&quot;+data;
window.location.href=newUrl;
}
});</code></pre><p>到这里已经可以获得正确的结果了。然而我还是想知道python的程序出了什么问题。<br>在某次退出重新登陆的时候，我取消了wechall那个锁定IP的选项……然后就顺利得出了正确的结果。<br>只能说无语凝噎。</p>
<pre><code>import requests as r
url = &quot;http://www.wechall.net/challenge/training/programming1/index.php?action=request&quot;
cookies = {&quot;WC&quot;: &quot;×××××××××××××&quot;}
resp = r.get(url, cookies=cookies)
ans = resp.text
print ans
resp = r.get(&quot;http://www.wechall.net/challenge/training/programming1/index.php?answer=%s&quot; % ans, cookies=cookies)
print resp.text</code></pre><h1 id="Training-PHP-LFI"><a href="#Training-PHP-LFI" class="headerlink" title="Training: PHP LFI"></a>Training: PHP LFI</h1><p>LFI这个奇怪的单词……我不知道L是什么，但FI是file include没错。看到了题目也进一步确认它就是文件包含漏洞的利用。</p>
<p>提供了整个页面的源代码，但并没用上。<br>另外提供了错误信息，看着它足以下饭了。</p>
<p>既然已经给出了答案的位置，直接访问<code>index.php?file=../solution.php</code><br>错误信息中，提示找不到文件”../solution.php.html”</p>
<p>于是很明显，需要尝试过滤掉后面的”.html”<br>利用nullbyte注入，访问<code>index.php?file=../solution.php%00</code><br>成功了，但是仍然提示找不到”../solution.php”</p>
<p>访问<code>index.php?file=../../solution.php%00</code>，完成。</p>
<h1 id="PHP-0817"><a href="#PHP-0817" class="headerlink" title="PHP 0817"></a>PHP 0817</h1><p>算是出题人的蓄意恶作剧吧。</p>
<p>看起来比上一题复杂，我以为是要用到nullbyte和php的字符串与数字转换的隐式规则。</p>
<p>答案是，php的switch对于条件的判断宽松得令人发指……</p>
<p>我承认我之前不知道这一点。</p>
<h1 id="Training-Crypto-Substitution-I"><a href="#Training-Crypto-Substitution-I" class="headerlink" title="Training: Crypto - Substitution I"></a>Training: Crypto - Substitution I</h1><p>单表替换密码，<a href="http://quipqiup.com/index.php" target="_blank" rel="noopener">quipqiup</a></p>
<p>我已经懒得手动做了。</p>
<h1 id="Training-Crypto-Caesar-II"><a href="#Training-Crypto-Caesar-II" class="headerlink" title="Training: Crypto - Caesar II"></a>Training: Crypto - Caesar II</h1><p>又是一个凯撒加密，准确地说是移位密码。只不过其空间为ascii的26-128</p>
<p>所以其实做法也是一样的，遍历一下所有可能性输出，扫一眼哪些看起来长得像就可以。</p>
<h1 id="Training-Regex"><a href="#Training-Regex" class="headerlink" title="Training: Regex"></a>Training: Regex</h1><p>正则表达式基础……分成了好几个关卡</p>
<ol>
<li><p>只匹配空字符串:<br>/^$/；这一步学习的是匹配字符串开头结尾的两个符号</p>
</li>
<li><p>只匹配wechall:<br>/^wechall$/；这一步是简单的匹配</p>
</li>
<li><p>匹配特定文件名的图片后缀：<br>/^wechall4?\.(?:jpg|gif|tiff|bmp|png)$/；稍微复杂一些的匹配，注意它会提示你不要使用捕获分组</p>
</li>
<li><p>同上题，需要对文件名添加捕获分组：<br>/^(wechall4?)\.(?:jpg|gif|tiff|bmp|png)$/</p>
</li>
</ol>
<h1 id="Training-MySQL-I"><a href="#Training-MySQL-I" class="headerlink" title="Training: MySQL I"></a>Training: MySQL I</h1><p>基础的SQL注入，<code>admin&#39; or &#39;&#39;like&#39;</code></p>
<h1 id="Training-MySQL-II"><a href="#Training-MySQL-II" class="headerlink" title="Training: MySQL II"></a>Training: MySQL II</h1><p>与上一题本质上相同，但这次的验证过程更为复杂：根据username取出结果，拿第一组结果中的密码与提交的密码的MD5比较，相同则视为登陆。</p>
<p>注意到成功登陆时，使用的是该组结果当中的username项，而非原来的username。从这里可以看出该题应当不需要二次SQL注入。</p>
<p>提交<code>username=&#39;union select 1,&#39;admin&#39;,&#39;e10adc3949ba59abbe56e057f20f883e; password=123456</code>即可，注意到其中e10adc3949ba59abbe56e057f20f883e为123456的MD5hash结果。</p>
<h1 id="Training-Register-Globals"><a href="#Training-Register-Globals" class="headerlink" title="Training: Register Globals"></a>Training: Register Globals</h1><p>利用php的register global选项，该选项将所有提交的参数注册为全局变量。<br>这个功能在php中已经移除。</p>
<p>查看源代码发现，其用$login这个变量来控制是否登陆，且只要$login[0]==admin,就能完成任务。</p>
<p>php的另一个特性是，可以通过get参数提交数组。</p>
<p>因此，在url后加上<code>?login[0]=admin</code>即可</p>
<h1 id="Limited-Access"><a href="#Limited-Access" class="headerlink" title="Limited Access"></a>Limited Access</h1><p>这道题关于.htcacess,我对于它不熟，应该说，对于apache都不熟。让我自己编写这个配置文件肯定没办法，然而……我只需要看懂就可以了。</p>
<p>显然能登陆的用户信息在.htpasswd里，这个文件访问不到。于是乎……看了看下面写的限制，貌似只对get进行了限制，那就简单了。直接用post查看该界面，就能通过了。</p>
<h1 id="Limited-Access-Too"><a href="#Limited-Access-Too" class="headerlink" title="Limited Access Too"></a>Limited Access Too</h1><p>这道题跟上一道题基本相同，我很无语。它的改动在于额外禁了一系列的http method。然而http的各种奇葩method太多，杀之不绝啊……</p>
<pre><code>curl -XTO http://www.wechall.net/challenge/wannabe7331/limited_access_too/protected/protected.php</code></pre><p>记得把cookie也一起提交上去。</p>
<p>你问我TO是什么？我估计是用不到的，所以我也没查。</p>
<h1 id="Enlightment"><a href="#Enlightment" class="headerlink" title="Enlightment"></a>Enlightment</h1><p>这道题……我一开始没做出来是犯了一个很大的错误。</p>
<p>由于经常用到把binary string转换成字符串的功能，其中需要每八个一组迭代一个字符串，而我之前竟然都是用slide_windows写的，觉得自己实在是蠢得不能再蠢了。</p>
<p>总之……现在是行了。</p>
<p>这道题的point在于，RGB三种颜色要怎么混合。一开始我想得有点复杂，把它们按照一般的RGB转灰度的公式处理……结果似乎是想复杂了。</p>
<p>其实只要把三个二进制串OR一下就可以了。</p>
<p>这只是第一步。第二步会给另一个二进制串，这个倒是可以直接转换成字符串。</p>
<p>第三步是另外的三个二进制串。这次不是OR一下，而是XOR一下。答案就有了。</p>
<pre><code>r = &quot;00000000011000000110000000000000000000000100000000010000000000000111000000100100001000000110100100010000000000000010100101100101011001000010000000000000000000000101010000000000011000100010000100101100011000000101000000100000001010010000001000000000000000000000100100000010011101000010000101000000011000010100001000010100011000010100011000100000001000000000010000000010000101110000010101101000001010000010000001100100000000010000000001000010001011100000000001110100000000100010000000010100011000000100000100100000000001100010010001011000011101000010000000100011011101000100000100100111010001000000110000000000010001100010001100100000011101000100100001100001010100000100010100110010000010010000101000000000001000010000000000010000001100010010000100110000001100000001000000010001001000000000000000100001000000000010000000110001000100000000000000000000001000000011000000000001000100000001000100000000000100000011000100000000000000010011000000000000001000000000110100001000000100000001000000100000001000000011000000000001000000000000000100100000000100010010000000010000001000010001000100000001000100000011000000010001001100000000000000010001000000000000000000010000000000000000000100100001000000000011000000110001000000000011000000001000000000000000000000000000000100010011000000100000000100010000000000110000000100000010000100110000000100000010000000110000001100000001000100100000001000000001000000010000001000000000000000000000000100000010000000010000001100000001000100000000001000000001000000010000000010000000100000100000001100000001000000010000000000000000000000010000001100000000000000110001001000010001000100000000000100000000000000000000001100000001000100110001001100000000000100110000000100000011000000000000000100000001000100110000000100000011000000000000000100000000000100000000&quot;


g =&quot;01000001011010000010000000000000000000000000000101100100000000000100000000100100010001000000010000100010000000000011100101000110011000000000000000100101010011000010000000000000001100110100100101100000001001010000000001000000001010000010011001100110001000000110100001000100010000000100010100110010001000000010000000110000001010010110000000000101000000010000100000001000010101110010000101000100010011000010000001000000001001100000000001100000000011010000000000010000011011100010000001100000001000000100010000000000011011000100010100010000001100000000000000110000000100000110000101100000011001010000110000000000010001010100010100100000000001000110100000000101011100100110010000000000000011010000000000110000000000000001000000110000000000000011000000010000000000000001000000010000000000010001000000110000000100000001000000000000000100000001000100110000000100000011000000110000001000010010000000010000000100010000000100110000000100010010000000010000001100000000100000000010001000000011000000010001000100000001000000100000001100000001000000010000001100000001000000000000000100000001000100110000001000010011000000100000000100000011000000100000001100000011000000010000000100000011000100010001001100000010000000000001000000000000000000000100000000100011000000100001001100010010000000110000001000010001000100000000000000000000000000100001001000000001000000100000000000000000000100010000000100000010000100100000001000000011000000000000001100000000000000010000001000010011000100110000000000000011000100010000000011000000100000010000000100000000000100010000001100010001000100000001001000000011000000100001001000000011000000000000000100000010000000110000001000000010000100100000000000000001000000100000001100000000000000110000001100010001000100110000001000000001000000110000000000000000100000001000&quot;

b = &quot;01000001010000000110000100100001001000000000100001000100001000000101001101100001011000010100000101100011001000000110000001001101000100010000000001100011001000110011010000100000010100110010111001001001011000010110010000101000011010000110110000100001000000000010000000101010000100000010010100010000000001000001001101000100000000000110110001000110000000010000010100001000000000010110010101100100011000000010000000110000010011110010000001000101010010100010000001000100000010110010000000100000000010000010000000000000011001000110000001101000001000000000000001000000001000000110000000000101000001010010100000100000001001110000111000100000001100000000100000000100000100100000010000001010000001000000101000010000000100010010000000000000000100000000000000000000001100000010000000100000000100000010000000100001001100000010000000110001001100000010000000000001000100000010000000010001000000000001000100100000001100010000000000000000001100000001000000100000000100000000100100001000000000000000000000100000000000010001000000110000000100010010000100110000001000000001000000100001001000000011000000110000001000010011000000000000000000000010000000110000000000010011000000100000001100000010000000110000000000000000000000110001001100000001000100000101000010000000000000010001001000010000000100010000001000000010000000110000001100000001000000010000001000000011000000110001001000000011000000000000001000010010000000100000000100010001000100110000000000000001000000100000001000010010000100010000001100000011000000100000000001010000001000100000000000000011000000100000000100010010000000110000000000000011000000010000000100010010000000110000001100000011000000100000001000000000000100010001001100000010000000010000001100000000000000000000000000000010000000000001001000000000000000000000001000000000110000001010&quot;


def bin2str(t):
    s=&quot;&quot;
    for i in range(len(t)/8):
        s+=chr(int(t[i*8:i*8+8],2))
    return s

s=&quot;&quot;
for i in range(len(r)):
    s += str(int(r[i]) | int(g[i]) | int(b[i]))

print bin2str(s)

# stage 2

s = &quot;&quot;&quot;01001100011010010110011101101000
00110111010111110100110001100101
01110110011001010110110000110010
00101110011100000110100001110000&quot;&quot;&quot;

s = s.replace(&apos;\n&apos;,&apos;&apos;)
print bin2str(s)

# stage 3
r = &quot;&quot;&quot;001111111000110110000110001011110011010010000000
110100111001010001010101010110000000101111110010
011100010011110001101000000010100101010101011110
100101001001100000100000001000010000111001010110
110011000110011011000010101010010001100111011110
011011011100101001101100100000110001010101001111
100100100100100011000000000001100101001100110000
110111000000001101010101100110101110000100100011
100011000100011010001011011011101101110000001000
110001011100000110011100110010001010100110010100
001111001101000001001111000111010100000000100000
110010000110110110010101011101101101110101111110
101110110110000101100000000100000000100110010100
100111000100010000100111001110011000000010100110
101111101010000100001111101110110100110100000010
000101110100010010001001100001011111101011001000
110000001001101011000100010101100111000010000110
110010111011001100000001000100001000010010000010
10011001010000100011100101011110&quot;&quot;&quot;

g = &quot;&quot;&quot;001000111110001110011011010011010000001011011110
101000001110000110100010001001011111010110011011
100001010100011000010001010110010010100110000010
101010110011011101000111011100100000010000111010
001110001000101010010000110001111100011100100001
000110101001011000011110001000101000011001000111
111000011010010010110000001000010001110100001000
100000011000100011010001101011000001110101000100
101110110000001101001001110110110011011110011101
101011110000100100110001000100011000000001011001
000000010010011110000100100110100001000101000100
010101010101001000000000011110011101010011011001
110100001000100000000110001101111010000001000000
111100101010100001001000001101110001101001001001
110001111101001100001100001000100100001010010000
110000010011000111001100001110101000011000111100
001100011010011110100010010110000000110111111101
111000010000100110011100110000001110110000111001
10000100101100011100101011101100&quot;&quot;&quot;

b = &quot;&quot;&quot;010010000001110001110100000100100101101000111011
010111100010110111011010001100101010110001000101
110101000000100000010000001101000001010010101000
000000001010001001101101000101000111100000001001
100101011001100001110011010011101001011010011010
000001010011100101010010110010001110000000101000
000001001000010000010001010100110110111001000001
001100101111111010100100010001011001010000001000
010000100010100110100110100101011000100111110000
010010101010010011000010101101100100001010100100
010100111001000011101011111000010011111000010110
101100110001000110111011000000100000001110000101
001011001000000000001011010010101100110010001011
001010101000110100110000010000101111001110001000
000100010000011000100001100101000000010111110111
101110000000000100100000110011010101110010000000
100110010101010000010101001011100001110000001000
000010101100101011111100101000110001101111001100
01110010100000011001011110010011&quot;&quot;&quot;

r = r.replace(&apos;\n&apos;,&apos;&apos;)
b = b.replace(&apos;\n&apos;,&apos;&apos;)
g = g.replace(&apos;\n&apos;,&apos;&apos;)

s=&quot;&quot;
for i in range(len(r)):
    s += str(int(r[i]) ^ int(g[i]) ^ int(b[i]))

print bin2str(s)</code></pre><h1 id="Guesswork"><a href="#Guesswork" class="headerlink" title="Guesswork"></a>Guesswork</h1><p>这道题还真是不那么令人愉快啊…</p>
<p>其目的是猜测一个账户的密码。据讨论区所说，可能有非纯猜测的方法，我觉得可能是社工。然而也没有英文的社工库，所以还是猜。</p>
<p>尝试了一些弱口令，当输入wechall的时候，虽然还是错的，但给出的回复有些不同，提示接近了。</p>
<p>我仍旧是猜不出来……然后在别人的提点下：它的账号是wechall，它的身份是个bot……</p>
<p>于是密码是wechallbot.我无言以对。</p>
<h1 id="No-Escape"><a href="#No-Escape" class="headerlink" title="No Escape"></a>No Escape</h1><p>很长的php代码审计，我原以为会是什么很复杂的东西，其实也不过是简单sql注入罢了。</p>
<p>只需对提交的参数做一点小手脚就可以了。</p>
<pre><code>？vote_for=bill`=111;#</code></pre><h1 id="Training-Crypto-Transposition-I"><a href="#Training-Crypto-Transposition-I" class="headerlink" title="Training: Crypto - Transposition I"></a>Training: Crypto - Transposition I</h1><p>这道题困扰了我一段时间……</p>
<p>对待置换密码，首先需要根据其长度特征进行判断.该文本的长度为148</p>
<p><code>factor 148</code>可以看到，其因数为2,2,37</p>
<p>看到这样的因数就知道，需要枚举的情况不会太多了。</p>
<p>无非是4*37,37*4,2*74,74*2这么几种情况。都枚举一下打印出来，看看是否能辨认出熟悉的单词的痕迹就好了。</p>
<h1 id="Training-LSB"><a href="#Training-LSB" class="headerlink" title="Training: LSB"></a>Training: LSB</h1><p>事实再次证明stegsolve是个好东西。</p>
<p>拖进去看一看各个通道有什么就好了</p>
<h1 id="Training-RegexMini"><a href="#Training-RegexMini" class="headerlink" title="Training: RegexMini"></a>Training: RegexMini</h1><p>一开始以为是php的漏洞，后来发现原来是简单干脆的正则表达式。</p>
<p>当然，是php的正则表达式。</p>
<p>具体可以参考<a href="http://php.net/manual/zh/regexp.reference.anchors.php" target="_blank" rel="noopener">php手册</a>,查看<code>^</code>和<code>$</code>这两个字符究竟能匹配些什么。</p>
<p>其实就是十六个A后面加一个换行符(<code>%0A</code>)就好了。</p>
<h1 id="PHP-0819"><a href="#PHP-0819" class="headerlink" title="PHP 0819"></a>PHP 0819</h1><p>这道题涉及到了一个以前没接触过的点。</p>
<p>php里有一个叫做heredoc的东西，用于实现python当中三引号差不多的功能，但语法上似乎更为复杂。</p>
<p>用这个东西便能绕过对于引号的过滤，注入想要的字符串</p>
<pre><code>%3C%3C%3CA%0A1337%0AA%3B%0A
&gt;&gt;&gt;A
1337
A;</code></pre><h1 id="Training-Warchall-The-Beginning"><a href="#Training-Warchall-The-Beginning" class="headerlink" title="Training: Warchall - The Beginning"></a>Training: Warchall - The Beginning</h1><ul>
<li><p>level 0: bitwarrior:</p>
</li>
<li><p>level 1: LameStartup:<br>通过find找到solution</p>
</li>
<li><p>level 2: HiddenIsConfig:<br>通过.bash_history找到</p>
</li>
<li><p>level 3: RepeatingHistory:<br>仍然是在.bash_history中找到</p>
</li>
<li><p>level 4: AndIknowchown:<br>一个没有权限的文件，但有改权限的权限</p>
</li>
<li><p>level 5: OhRightThePerms:<br>仍然是改权限的小游戏</p>
</li>
</ul>
<p>我花了很长很长时间去做level6……然后发现只要求输入level0~5的密码。</p>
<p>最后……记得加上逗号</p>
<h1 id="Py-Tong"><a href="#Py-Tong" class="headerlink" title="Py-Tong"></a>Py-Tong</h1><p>需要一个程序与提供的程序达成race condition，多试几次就能输出正确的结果了。</p>
<pre><code>#!/usr/bin/env python
# coding=utf-8
import os
while True:
    os.remove(&apos;/home/user/winkar/test&apos;)
    f= open(&apos;/home/user/winkar/test&apos;, &quot;a+&quot;)
    f.close()</code></pre><h1 id="PHP-0815"><a href="#PHP-0815" class="headerlink" title="PHP 0815"></a>PHP 0815</h1><p>我自己想不到的hack。</p>
<p>缺失的环节是，传入的参数需要转换成整数。</p>
<p>通常所用的函数是int()或者intval()</p>
<p>然而出于php wtf的atoi转换规则，$s-0足以完成。于是<code>-0</code>就是最短的答案</p>
<h1 id="Impossible-n’est-pas-francais"><a href="#Impossible-n’est-pas-francais" class="headerlink" title="Impossible n’est pas français"></a>Impossible n’est pas français</h1><p>题目的要求是factor一个很大的数字。试着看了看那个数字的长度之后我放弃了正常途径。</p>
<p>我开始寻找是否有api可以完成这个工作。</p>
<p>其实只要提交一个错误的答案，wechall就会告诉你正确的答案。</p>
<p>于是乎……</p>
<pre><code>#!/usr/bin/env python
# coding=utf-8

import lxml
import lxml.html as H
import requests

cookie = {
    &apos;WC&apos;: &apos;8429765-12152-0vjRl2XoKWFYAmvh&apos;
}


def get_number():
    number_url = &apos;http://www.wechall.net/challenge/impossible/index.php?request=new_number&apos;
    resp = requests.get(number_url, cookies=cookie)
    d = H.document_fromstring(resp.text)
    return str(d.xpath(&apos;//div[@id=\&apos;page\&apos;]&apos;)[0].text_content()).strip()


print get_number()

def get_answer():
    post_data = {
        &apos;solution&apos;: &apos;1+12&apos;,
        &apos;cmd&apos;: &apos;Send&apos;,
        &apos;gwf3_csrf&apos;: &apos;2XDoWTUR&apos;
    }
    url = &apos;http://www.wechall.net/challenge/impossible/index.php&apos; 
    resp = requests.post(url, cookies=cookie, data=post_data)
    # print resp.text
    d = H.document_fromstring(resp.text)
    import re
    ar = re.compile(r&apos;&quot;(\d+)&quot;&apos;)
    text = d.xpath(&apos;//div[@class=\&apos;gwf_errors\&apos;]/ul/li&apos;)[0].text_content()
    ans = ar.findall(text)[0]

    print ans 

    post_data = {
        &apos;solution&apos;: ans,
        &apos;cmd&apos;: &apos;Send&apos;,
        &apos;gwf3_csrf&apos;: &apos;2XDoWTUR&apos;
    }

    resp = requests.post(url, cookies=cookie, data=post_data)
    print resp.text

get_answer()</code></pre><h1 id="Stegano-Attachment"><a href="#Stegano-Attachment" class="headerlink" title="Stegano Attachment"></a>Stegano Attachment</h1><p>xxd一看就知道，提供的jpg图片里面藏了一个zipfile。如果是当年懵懂无知的我，要提取出来还是会很费劲的。</p>
<p>然而现在……</p>
<pre><code>foremost -i attachment.php(这是下载过来图片的名字)</code></pre><p>一切尽在不言中</p>
<h1 id="PHP-0818"><a href="#PHP-0818" class="headerlink" title="PHP 0818"></a>PHP 0818</h1><p>这道题又一次让我对php这门语言绝望了。</p>
<p>不允许出现数字但又要求与一个数字相等，无非就是字符串与数字转换的规则问题。</p>
<p>一串字母如何与一个数字相等，自然是十六进制。</p>
<p>十六进制的字符串为何能与十进制的字符串相等……那就说来话长了，可以去看一看php中”==” 与 “===”这两个操作符的区别。</p>
<p>强烈推荐，除非故意要留下这么个漏洞，不然不要用前者</p>
<h1 id="Stop-us"><a href="#Stop-us" class="headerlink" title="Stop us"></a>Stop us</h1><p>又一个未涉及过的知识点。</p>
<p>也又一次让我觉得php这门语言……虽说C/C++的“未定义”让人咬牙切齿，可跟php里这种种特意定义出来的bug相比，不值一提</p>
<p>这次是ignore_user_abort，将此选项置false的情况下，客户端中断连接将使脚本执行停止。</p>
<p>一个活生生的事务处理的原子性不能达成的例子。</p>
<h1 id="Are-you-serial"><a href="#Are-you-serial" class="headerlink" title="Are you serial"></a>Are you serial</h1><p>给出了很多代码，不过也算是有重点。首先是一个标题名，表示可能与php中的序列化函数有关。</p>
<p>然后是一个叫做insecure.inc.php的文件，没几行代码，里面用到spl_autoload_register这个函数。由于php中的register劣迹斑斑，果断去搜索了一圈这个函数的用法。</p>
<p>这个不安全的文件实现的大致效果是，当碰到一个找不到的类时，php会通过注册的函数，自动在include path当中寻找并包含对应的文件。再看一眼solution这个文件大致的思路就拼凑出来了。在cookie中提交一个solution类的序列化字符串即可。</p>
<pre><code>#!/usr/bin/env python
# coding=utf-8

import requests

solution = r&apos;O:15:&quot;SERIAL_Solution&quot;:0:{}&apos;

cookie = {
    &apos;WC&apos;: &apos;8429765-12152-0vjRl2XoKWFYAmvh&apos;,
    &apos;serial_user&apos;: solution,
}

resp = requests.post(&apos;http://www.wechall.net/challenge/are_you_serial/code.php&apos; ,cookies=cookie)
print resp.text</code></pre><h1 id="Training-Math-Pyramid"><a href="#Training-Math-Pyramid" class="headerlink" title="Training: Math Pyramid"></a>Training: Math Pyramid</h1><p>这道题坑人的地方在于故意给你的sqrt，不用它会大大减低难度<br>    a^3/18^.5</p>
<h1 id="Training-Crypto-Digraphs"><a href="#Training-Crypto-Digraphs" class="headerlink" title="Training: Crypto - Digraphs"></a>Training: Crypto - Digraphs</h1><p>这道题麻烦的地方是，大小写字母的编码方式是不同的，且标点符号也在编码的范畴之内。因此不能将其转换成普通的单表替换密码。</p>
<p>比较明显提示是，第一个单词的长度，结合该语境，它无疑是congratulations，这样好多字母对应的key已经获得。接下来只要把剩余的每一个单词的密文在已有字典中检索一遍，再根据拼凑出的碎片还原整个单词，再更新字典即可。</p>
<p>事实上凑到最后我还有一两个字母没有确定，不过已经不妨碍了。</p>
<h1 id="HOST-me"><a href="#HOST-me" class="headerlink" title="HOST me"></a>HOST me</h1><p>比较别扭，查了HTTP_HOST之后就知道该在HEADERS的HOST上动手脚，然而不知为何，无论是用requests还是用chrome改header怎么发都提示Wrong Host。</p>
<p>最后的解决方案是在nc里直接发一个最简洁的http报文，就能返回正确的结果了。</p>
<pre><code>GET http://www.wechall.net/challenge/space/host_me/index.php HTTP/1.1
Host: localhost
Cookie: </code></pre><h1 id="AUTH-me"><a href="#AUTH-me" class="headerlink" title="AUTH me"></a>AUTH me</h1><p>对于SSL还是很不了解，这个apache.conf在讲什么……我也是完全当做英文理解的，大致对于一些点去查了一查，并无什么收获。</p>
<p>其实在apache.conf中规定了，client端需要证书才能访问server端，那么证书在哪里呢。就放在<code>/challenge/space/auth_me/find_me/</code>文件夹下(即apache.conf所在文件夹)……</p>
<p>导入浏览器即可</p>
<h1 id="Stegano-Woman"><a href="#Stegano-Woman" class="headerlink" title="Stegano Woman"></a>Stegano Woman</h1><p>给了一个压缩包，里面有两张图片。用各种stegano检测的工具对两张图片上上下下检查了一圈，什么都没有看出来，很是尴尬……</p>
<p>在某次解压缩的过程中(用的是命令行的zip)，发现除了解压出来的文件列表外，还额外输出了一大堆东西。现在我已经知道了，输出的这些东西是zip文件当中的备注。</p>
<p>于是后面的过程就是把备注找出来,发现接在stegano字符串后面的,是一大串TAB和SPC.把其中一个当做1,另一个当做0,换成二进制再转换成字符串之后输出即可.</p>
<pre><code>with open(&apos;00000000.zip&apos;,&apos;rb&apos;) as f:
    text = f.read()

index = text.find(&apos;Stegano&apos;)
text = [x for x in text[index:] if x]
text = text[:273]
text = text[9:]
text = &apos;&apos;.join(&apos;1&apos; if x==&apos; &apos; else &apos;0&apos; for x in text)

s=&quot;&quot;
for l in range(len(text)/8):
   s+= chr(int(text[l*8:l*8+8],2)) 

print s</code></pre><h1 id="Connect-the-Dots"><a href="#Connect-the-Dots" class="headerlink" title="Connect the Dots"></a>Connect the Dots</h1><p>名字上已经可以看出来把各个黑点(或者白点)连起来能看出一点信息,然而连了半天什么都没看出来.</p>
<p>随后搜索得到结果,原来这里使用的是盲文,难怪….</p>
<h1 id="Training-Baconian"><a href="#Training-Baconian" class="headerlink" title="Training: Baconian"></a>Training: Baconian</h1><p>so called 培根密码,我保证这个加密不会是你感兴趣的.寻找工具而非自己编码是更好的方式,只需按大小写将其转换为’A’和’B’,之后丢到这个网站<a href="http://rumkin.com/tools/cipher/baconian.php" target="_blank" rel="noopener">Bacon</a>就可以了.</p>
<p>注意大小写which is A and which is B is important.And 培根密码有两种加密形式,取决于ij 和 uv 是否采取同一种编码</p>
<h1 id="Zebra"><a href="#Zebra" class="headerlink" title="Zebra"></a>Zebra</h1><p>这道题本身是不难的,在对图片进行分析之后,不难发现斑马身上的条纹很像一个一维条形码(barcode).接下来便是将其抠出来, 无非是gimp, ps, mspaint之类的工具都能解决.</p>
<p>真正困扰我的是,如何识别出条形码里的内容.我试着根据EAN-13的规则人工识别,惨败.之后在手机上下了APP,仍旧是失败.最终给出结果的是这个网站<a href="http://online-barcode-reader.inliteresearch.com/" target="_blank" rel="noopener">barcode online reader</a></p>
<h1 id="Training-Crypto-Substitution-II"><a href="#Training-Crypto-Substitution-II" class="headerlink" title="Training: Crypto - Substitution II"></a>Training: Crypto - Substitution II</h1><p>与diagraph相同, 采用了wechall环境下密码题的”congratulations!”解题法.</p>
<p>这么一大串东西,直接猜测是以congratulations!开头, 替换完之后发现长得的确看起来像那么回事,于是一点点拆解单词,很快就能把原貌还原.</p>
<h1 id="eXtract-Me"><a href="#eXtract-Me" class="headerlink" title="eXtract Me"></a>eXtract Me</h1><p>给了一个zip文件,仔细研究其内部结构发现在zip结束符之后还有额外的部分.顺带一提,这本该是foremost或者binwalk完成的工作,可是它们都检测不出来….</p>
<p>前半个部分,也就是zip文件,一个440B大小的无限循环解压的zip文件,跟它较劲毫无意义.而后半部分导出后是用奇怪的手法层层包扎的压缩包.未统计,可能有那么七八层.</p>
<p>解压的过程中要灵活运用<code>file</code>命令来探知压缩包的格式.已经7z可以方便地解压很多种类的压缩包,虽然还是有那么一些奇怪的类型需要安装对应的软件用以解压..</p>
<p>第一遍解压到最后,结果蹦出来一句话:L0LYouThInkiTSh0uldB3SoEasY? 这已经不知道是第几次被出题者戏耍了.这句话虽然不是答案,但也是有用的.</p>
<p>另一个分岔实际上在解压某一个rar文件时,会给出一大串十六进制, 将其导出为二进制文件,又是一个压缩包,还是层层解压.</p>
<p>到最后又是获得了一个rar文件,然而它有密码. 一开始在这里愣神了,以为是假密码,修改标志位后却提示已经损坏. 总算想起来之前获得了一个字符串,一试果然成功,获得最终的答案</p>
<h1 id="htmlspecialchars"><a href="#htmlspecialchars" class="headerlink" title="htmlspecialchars"></a>htmlspecialchars</h1><p>这道题一股蛋疼感.</p>
<p>exploit payload:</p>
<pre><code>test&apos; onclick=&apos;alert(123)&apos;</code></pre><p>切记不要在chrome下测试…我没有装任何adblock但它还是不弹窗.</p>
<p>可以看出原反XSS代码的主要问题就是没对单引号做转义</p>
<p>查看htmlspecialchars的文档,发现它默认不对单引号做转义,加上<code>ENT_QUOTES</code>参数就可以.</p>
<h1 id="PHP-0816"><a href="#PHP-0816" class="headerlink" title="PHP 0816"></a>PHP 0816</h1><p>整理一下整个script走过的路径.</p>
<p>1.检查参数src,如果值不在白名单里,则将值置false<br>2.将参数hl数组中的值加入highlight列表<br>3.检查参数mode,如果mode为hl则调用函数载入src参数指定的文件.</p>
<p>虽然我在上面标了一二三,但注意源代码当中,这三者之间并无顺序.</p>
<p>php中foreach是按照数组的赋值顺序遍历的, 关于GET参数的传入顺序我并无找到资料, 也懒得做实验, 根据这道题的结果来看大概也是跟url中参数的传入顺序有关的.</p>
<p>因此只要在白名单过滤之前载入src参数指定的文件就可以.</p>
<pre><code>http://www.wechall.net/challenge/php0816/code.php?mode=hl&amp;src=solution.php</code></pre><h1 id="Quangcurrency"><a href="#Quangcurrency" class="headerlink" title="Quangcurrency"></a>Quangcurrency</h1><p>读题是很重要的…来把这个题目大概念出来,它是什么?concurrency对不对?又是一道竞态的题目.</p>
<p>只要卡着buy和click,想方设法跑到10个item就可以</p>
<pre><code>cookie = {
    &apos;WC&apos;: &apos;8429765-12152-0vjRl2XoKWFYAmvh&apos;
}

def f1():
    requests.get(&apos;http://www.wechall.net/challenge/quangcurrency/click.php&apos;, cookies=cookie)

def f2():
    requests.get(&apos;http://www.wechall.net/challenge/quangcurrency/buy.php&apos;, cookies=cookie)
import requests
import threading
import time

import lxml
import lxml.html as H
import re

r = re.compile(r&apos;\w+: (\d+)&apos;)

i = 0 
while True:
    i += 1
    print &quot;turn %d&quot; % i
    print &apos;start click&apos;
    t1 = threading.Thread(target = f1)
    print &apos;start buy&apos;
    t2 = threading.Thread(target = f2)

    t1.start()
    t2.start()
    t1.join()
    t2.join()

    text = requests.get(&apos;http://www.wechall.net/challenge/quangcurrency/stats.php&apos;, cookies=cookie).text
    d = H.document_fromstring(text)
    msg = d.xpath(&apos;//div[@class=\&apos;box_c\&apos;]&apos;)[0]
    # import pdb;pdb.set_trace()
    a,b,c  = r.findall(msg.text_content())
    print &apos;get %s item &apos; % c

    if int(c)&gt;=10:
        break

    if int(a) &lt; 1000:
        print &apos;reset&apos;
        requests.get(&apos;http://www.wechall.net/challenge/quangcurrency/reset.php&apos;, cookies=cookie)</code></pre><p>友情提示,它肯定可以跑出来,但它永远不会停下,最好自己确认这个challenge是不是已经完成了.</p>
<h1 id="Yourself-PHP"><a href="#Yourself-PHP" class="headerlink" title="Yourself PHP"></a>Yourself PHP</h1><p>我研究怎么绕过htmlspecialchars花了很长时间,然而得出的结论是这个地方似乎不太能绕过.</p>
<p>后来了解到注入点不在username, 而在$_SERVER[‘PHP_SELF’], 所以….足够仔细的代码审计非常重要.</p>
<pre><code>http://www.wechall.net/challenge/yourself_php/index.php/%22%3E%3Cscript%3Ealert(1);%3C/script%3E</code></pre><p>用上面这个url访问即可</p>
<h1 id="The-Guestbook"><a href="#The-Guestbook" class="headerlink" title="The Guestbook"></a>The Guestbook</h1><p>SQL注入.</p>
<p>其关键在于绕过对输入的过滤,当然我的确不知道怎么在有过滤的情况下完成注入,但仔细审查源代码会发现,除了输入的信息之外,ip和sessionid都是未过滤的注入点.</p>
<p>Session id不方便下手,那么ip就是最好的选择</p>
<pre><code>X-Forwarded-For: &apos;,(SELECT gbu_password from gbook_user limit 1));#</code></pre><p>构造这样的http header, 再提交message即可将查询到的结果输出.</p>
<h1 id="Crappyshare"><a href="#Crappyshare" class="headerlink" title="Crappyshare"></a>Crappyshare</h1><p>仍旧是代码审计,文件包含漏洞…但是你得知道怎么通过文件包含漏洞去访问到solution.php</p>
<p><a href="http://www.cnblogs.com/littlehann/p/3665062.html" target="_blank" rel="noopener">php 封装协议</a>这篇文章中讲解了一系列相关的知识.</p>
<p>使用<code>file://</code>协议可以令其访问本地文件</p>
<h1 id="Pimitive-Encryption"><a href="#Pimitive-Encryption" class="headerlink" title="Pimitive Encryption"></a>Pimitive Encryption</h1><p>用onetime-pad xor加密的zip文件,通过zip的magic number可以确定onetime-pad的前四位,转换成char输出后发现是3.14</p>
<p>于是该用什么解密就很明显了,下载一个pi之后xor一下,就能还原了.</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/01/31/emacs/" rel="prev" title="Emacs 环境搭建">
                Emacs 环境搭建 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">WinKaR</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#PrimeFactory"><span class="nav-number">1.</span> <span class="nav-text">PrimeFactory</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Get-Sourced"><span class="nav-number">2.</span> <span class="nav-text">Get Sourced</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Stegano-I"><span class="nav-number">3.</span> <span class="nav-text">Stegano I</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Crypto-Caesar-I"><span class="nav-number">4.</span> <span class="nav-text">Crypto-Caesar I</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#WWW-Robots"><span class="nav-number">5.</span> <span class="nav-text">WWW-Robots</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Ascii"><span class="nav-number">6.</span> <span class="nav-text">Ascii:</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Encoding-URL"><span class="nav-number">7.</span> <span class="nav-text">Encoding: URL</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Training-Encodings-I"><span class="nav-number">8.</span> <span class="nav-text">Training:Encodings I</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Training-Programming-1"><span class="nav-number">9.</span> <span class="nav-text">Training: Programming 1</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Training-PHP-LFI"><span class="nav-number">10.</span> <span class="nav-text">Training: PHP LFI</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PHP-0817"><span class="nav-number">11.</span> <span class="nav-text">PHP 0817</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Training-Crypto-Substitution-I"><span class="nav-number">12.</span> <span class="nav-text">Training: Crypto - Substitution I</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Training-Crypto-Caesar-II"><span class="nav-number">13.</span> <span class="nav-text">Training: Crypto - Caesar II</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Training-Regex"><span class="nav-number">14.</span> <span class="nav-text">Training: Regex</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Training-MySQL-I"><span class="nav-number">15.</span> <span class="nav-text">Training: MySQL I</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Training-MySQL-II"><span class="nav-number">16.</span> <span class="nav-text">Training: MySQL II</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Training-Register-Globals"><span class="nav-number">17.</span> <span class="nav-text">Training: Register Globals</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Limited-Access"><span class="nav-number">18.</span> <span class="nav-text">Limited Access</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Limited-Access-Too"><span class="nav-number">19.</span> <span class="nav-text">Limited Access Too</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Enlightment"><span class="nav-number">20.</span> <span class="nav-text">Enlightment</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Guesswork"><span class="nav-number">21.</span> <span class="nav-text">Guesswork</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#No-Escape"><span class="nav-number">22.</span> <span class="nav-text">No Escape</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Training-Crypto-Transposition-I"><span class="nav-number">23.</span> <span class="nav-text">Training: Crypto - Transposition I</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Training-LSB"><span class="nav-number">24.</span> <span class="nav-text">Training: LSB</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Training-RegexMini"><span class="nav-number">25.</span> <span class="nav-text">Training: RegexMini</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PHP-0819"><span class="nav-number">26.</span> <span class="nav-text">PHP 0819</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Training-Warchall-The-Beginning"><span class="nav-number">27.</span> <span class="nav-text">Training: Warchall - The Beginning</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Py-Tong"><span class="nav-number">28.</span> <span class="nav-text">Py-Tong</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PHP-0815"><span class="nav-number">29.</span> <span class="nav-text">PHP 0815</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Impossible-n’est-pas-francais"><span class="nav-number">30.</span> <span class="nav-text">Impossible n’est pas français</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Stegano-Attachment"><span class="nav-number">31.</span> <span class="nav-text">Stegano Attachment</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PHP-0818"><span class="nav-number">32.</span> <span class="nav-text">PHP 0818</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Stop-us"><span class="nav-number">33.</span> <span class="nav-text">Stop us</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Are-you-serial"><span class="nav-number">34.</span> <span class="nav-text">Are you serial</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Training-Math-Pyramid"><span class="nav-number">35.</span> <span class="nav-text">Training: Math Pyramid</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Training-Crypto-Digraphs"><span class="nav-number">36.</span> <span class="nav-text">Training: Crypto - Digraphs</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HOST-me"><span class="nav-number">37.</span> <span class="nav-text">HOST me</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#AUTH-me"><span class="nav-number">38.</span> <span class="nav-text">AUTH me</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Stegano-Woman"><span class="nav-number">39.</span> <span class="nav-text">Stegano Woman</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Connect-the-Dots"><span class="nav-number">40.</span> <span class="nav-text">Connect the Dots</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Training-Baconian"><span class="nav-number">41.</span> <span class="nav-text">Training: Baconian</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Zebra"><span class="nav-number">42.</span> <span class="nav-text">Zebra</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Training-Crypto-Substitution-II"><span class="nav-number">43.</span> <span class="nav-text">Training: Crypto - Substitution II</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#eXtract-Me"><span class="nav-number">44.</span> <span class="nav-text">eXtract Me</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#htmlspecialchars"><span class="nav-number">45.</span> <span class="nav-text">htmlspecialchars</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PHP-0816"><span class="nav-number">46.</span> <span class="nav-text">PHP 0816</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Quangcurrency"><span class="nav-number">47.</span> <span class="nav-text">Quangcurrency</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Yourself-PHP"><span class="nav-number">48.</span> <span class="nav-text">Yourself PHP</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#The-Guestbook"><span class="nav-number">49.</span> <span class="nav-text">The Guestbook</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Crappyshare"><span class="nav-number">50.</span> <span class="nav-text">Crappyshare</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Pimitive-Encryption"><span class="nav-number">51.</span> <span class="nav-text">Pimitive Encryption</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">WinKaR</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
